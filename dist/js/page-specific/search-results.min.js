"use strict";namespacer("bcpl.pageSpecific"),bcpl.pageSpecific.search=function(e,r,t,a){var n=function(r){e.ajax(a.search.urls.materialTypes).then(function(e){return r(e)},function(e){return console.log(e)})},s=function(e,r,t){return Array.from({length:r-e+1},function(r,a){return{page:a+e,isCurrent:a+e===t}})},u=function(e,r){if(r<=1||r<e)return 1;var t=r-e;return e<=3&&r<=5?s(1,r,e):e<=3&&r>=5?s(1,5,e):t>=2?s(e-2,e+2,e):r<=5?s(1,r,e):s(r-4,r,e)},c=function(t){var a=t;a.SearchResults.length>0?(a.ResultsPerPageButtons=[{count:10,isCurrent:10===t.ResultsPerPage},{count:25,isCurrent:25===t.ResultsPerPage},{count:50,isCurrent:50===t.ResultsPerPage},{count:100,isCurrent:100===t.ResultsPerPage}],a.PageNumbers=u(a.CurrentPage,a.Pages),n(function(t){var n=[];_.map(a.SearchResults,function(e){var r=e;r.icon=t[_.findIndex(t,{id:parseInt(e.PrimaryTypeOfMaterial,10)})].icon,n.push(r)}),a.SearchResults=n;var s=e("#search-results-template").html(),u=r.compile(s),c=u(a);e(".loading").hide(),e("#search-results").html(c)})):e(".no-results").show()},i=function(e){console.log(e)},o=function(e,r,t){window.location=window.location.pathname+"?q="+e+"&page="+r+"&resultsPerPage="+t},l=function(r){var t=e(r.currentTarget),a=t.attr("data-results-per-page");o(r.data.searchTerm,r.data.pageNumber,a)},p=function(r){var t=e(r.currentTarget),a=t.attr("data-page-number");o(r.data.searchTerm,a,r.data.selectedResultsPerPage)};return{init:function(){var r=t.getAsDictionary();if(r.q){var a=r.q.trim(),n=r.page?r.page:1,s=r.resultsperpage?r.resultsperpage:10;e(document).on("click","#pager .results-per-page button",{searchTerm:a,pageNumber:n,resultsPerPage:s},l),e(document).on("click","#pager .page-numbers button",{searchTerm:a,pageNumber:n,resultsPerPage:s},p),e.get(bcpl.constants.baseApiUrl+"/api/polaris/search/"+a+"/"+n+"/"+s).then(c,i)}else e(".loading").hide(),e(".no-results").show()}}}(jQuery,Handlebars,bcpl.utility.querystringer,bcpl.constants),$(function(){bcpl.pageSpecific.search.init()});