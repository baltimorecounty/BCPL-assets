"use strict";namespacer("bcpl.pageSpecific"),bcpl.pageSpecific.search=function(e,r,t){var a=function(r){e.ajax(bcpl.constants.baseApiUrl+"/data/primaryMaterialType.json").then(function(e){return r(e)},function(e){return console.log(e)})},n=function(e,r,t){return Array.from({length:r-e+1},function(r,a){return{page:a+e,isCurrent:a+e===t}})},s=function(e,r){if(r<=1||r<e)return 1;var t=r-e;return e<=3&&r<=5?n(1,r,e):e<=3&&r>=5?n(1,5,e):t>=2?n(e-2,e+2,e):r<=5?n(1,r,e):n(r-4,r,e)},u=function(t){var n=t;n.SearchResults.length>0?(n.ResultsPerPageButtons=[{count:10,isCurrent:10===t.ResultsPerPage},{count:25,isCurrent:25===t.ResultsPerPage},{count:50,isCurrent:50===t.ResultsPerPage},{count:100,isCurrent:100===t.ResultsPerPage}],n.PageNumbers=s(n.CurrentPage,n.Pages),a(function(t){var a=[];_.map(n.SearchResults,function(e){var r={};r.icon=t[_.findIndex(t,{id:parseInt(e.PrimaryTypeOfMaterial,10)})].icon,a.push(r)}),n.SearchResults=a;var s=e("#search-results-template").html(),u=r.compile(s),c=u(n);e(".loading").hide(),e("#search-results").html(c)})):e(".no-results").show()},c=function(e){console.log(e)},i=function(e,r,t){window.location=window.location.pathname+"?q="+e+"&page="+r+"&resultsPerPage="+t},o=function(r){var t=e(r.currentTarget),a=t.attr("data-results-per-page");i(r.data.searchTerm,r.data.pageNumber,a)},l=function(r){var t=e(r.currentTarget),a=t.attr("data-page-number");i(r.data.searchTerm,a,r.data.selectedResultsPerPage)};return{init:function(){var r=t.getAsDictionary();if(r.q){var a=r.q.trim(),n=r.page?r.page:1,s=r.resultsperpage?r.resultsperpage:10;e(document).on("click","#pager .results-per-page button",{searchTerm:a,pageNumber:n,resultsPerPage:s},o),e(document).on("click","#pager .page-numbers button",{searchTerm:a,pageNumber:n,resultsPerPage:s},l),e.get(bcpl.constants.baseApiUrl+"/api/polaris/search/"+a+"/"+n+"/"+s).then(u,c)}else e(".loading").hide(),e(".no-results").show()}}}(jQuery,Handlebars,bcpl.utility.querystringer),$(function(){bcpl.pageSpecific.search.init()});