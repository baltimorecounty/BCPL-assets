"use strict";!function(e){var t=angular.module("dataServices",[]),n=function(t,n,a){var s=function(e,t){return new Date(e.EventStart).toLocaleDateString()===t},r=function(e){var t=[],n=void 0;return angular.forEach(e,function(a){var r=new Date(a.EventStart).toLocaleDateString();n!==r&&(t.push({date:new Date(a.EventStart),events:e.filter(function(e){return s(e,r)})}),n=r)}),t},i=function(e){return e.replace(":00","").replace(/\w\w$/,function(e){return e.split("").join(".")+"."})},p=function(t){var n=t,a=e(t.EventStart);return n.eventMonth=a.format("MMM"),n.eventDate=a.format("D"),n.eventTime=i(a.format("h:mm a")),n.requiresRegistration=0!==n.RegistrationTypeCodeEnum,n},l=function(e){var t=[];return e.forEach(function(e){var n=p(e);t.push(n)}),t};return{get:function(e){return a(function(a,s){n.post(t.baseUrl+t.serviceUrls.events,e).then(function(e){e.data?a({eventGroups:r(e.data.Events),totalResults:e.data.TotalResults}):s(e)},s)})},getById:function(e){return a(function(a,s){n.get(t.baseUrl+t.serviceUrls.events+"/"+e).then(function(e){e.data?(e.data.Description&&(e.data.Description=e.data.Description.replace(/<[\w\/]+>/g,"")),a(e.data)):s(e)},s)})},getFeaturedEvents:function(e){return a(function(a,s){n.post(t.baseUrl+t.serviceUrls.events,e).then(function(e){e.data?a(l(e.data.Events)):s(e)},s)})}}};n.$inject=["events.CONSTANTS","$http","$q"],t.factory("dataServices.eventsService",n)}(window.moment),function(){angular.module("featuredEventsWidget",["dataServices","events"])}(),function(){var e=angular.module("events",[]),t={baseUrl:"http://oit226471:1919",serviceUrls:{events:"/api/evanced/signup/events",eventRegistration:"/api/evanced/signup/registration"},remoteServiceUrls:{ageGroups:"https://bcpl.evanced.info/api/signup/agegroups",eventTypes:"https://bcpl.evanced.info/api/signup/eventtypes",locations:"https://bcpl.evanced.info/api/signup/locations"},templateUrls:{datePickersTemplate:"/_js/apps/events-page/templates/datePickers.html",eventsListTemplate:"/_js/apps/events-page/templates/eventsList.html",filtersTemplate:"/_js/apps/events-page/templates/filters.html",filtersExpandosTemplate:"/_js/apps/events-page/templates/filters-expandos.html",loadMoreTemplate:"/_js/apps/events-page/templates/loadMore.html",featuredEventsTemplate:"/_js/apps/events-page/templates/featuredEvents.html"},partialUrls:{eventListPartial:"/_js/apps/events-page/partials/eventList.html",eventDetailsPartial:"/_js/apps/events-page/partials/eventDetails.html",eventRegistrationPartial:"/_js/apps/events-page/partials/eventRegistration.html"},requestChunkSize:10};e.constant("events.CONSTANTS",t)}(),function(e){var t=function(e,t){var n=e.branches&&e.branches.length?e.branches:[],a=e.eventTypes&&e.eventTypes.length?e.eventTypes:[],s=e.resultsToDisplay||3,r=!!e.prioritizeFeatured,i=function(e){return console.error(e)},p=function(e,t,s,r){var i={Limit:e,OnlyFeaturedEvents:r};return n.length&&(i.Locations=t),a.length&&(i.EventsTypes=s),i}(s,n,a,r);t.getFeaturedEvents(p).then(function(t){e.featuredEventList=t,0===t.length&&(e.resultsToDisplay=0)}).catch(i)},n=function(e,n){return{restrict:"E",scope:{branches:"=",resultsToDisplay:"=",eventTypes:"=",prioritizeFeatured:"="},templateUrl:e.templateUrls.featuredEventsTemplate,link:function(e){return t(e,n)}}};n.$inject=["events.CONSTANTS","dataServices.eventsService"],e.directive("featuredEvents",n)}(angular.module("featuredEventsWidget"));