"use strict";!function(e,t){var a=function(e,a,n,r,s,o,i,u,l,c,d){var p=this,v=["locations","eventTypes","ageGroups"],f=function(){return o.moment().format()},m=function(){return o.moment().add(30,"d").format()};p.requestModel=new d;var g={zIndex:100,responsiveWidth:!0};p.eventGroups=[],p.keywords="",p.chunkSize=i.requestChunkSize,p.totalResults=0,p.isLastPage=!1,p.areDatesInvalid=!1,p.isLoading=!0,p.hasResults=!0,p.data={},p.locations=[],p.eventsTypes=[],p.ageGroups=[];var h=function(e){var t=[],a=[];return e.Locations.length?t.push("locations"):a.push("locations"),e.EventsTypes.length?t.push("eventTypes"):a.push("eventTypes"),e.AgeGroups.length?t.push("ageGroups"):a.push("ageGroups"),{activePanels:t,inActivePanels:a}};p.filterEvents=function(a,n,r){p.eventGroups=[],p.isLoading=!0,p.hasResults=!0,p.requestErrorMessage="",p.requestModel=a;var s=angular.element("#start-date")[0]._flatpickr,i=angular.element("#end-date")[0]._flatpickr;e.ready(function(){s.setDate(o.moment(a.StartDate).toDate()),i.setDate(o.moment(a.EndDate).toDate()),p.userStartDate=o.moment(a.StartDate).format("MMMM DD, YYYY"),p.userEndDate=o.moment(a.EndDate).format("MMMM DD, YYYY")}),u.get(a).then(function(e){b(e),p.hasResults=!!y(e);var s=h(a);n&&t.toggleCollapseByIds(s),r&&"function"==typeof r&&r(e)}).catch(D)};var y=function(e){return e&&Object.prototype.hasOwnProperty.call(e,"totalResults")?e.totalResults:0};p.keywordSearch=function(){var e=Object.assign({},p.requestModel);e.Keyword=p.keywords,e.Page=1,l.setQueryParams([{key:"term",val:p.keywords}])},p.filterByDate=function(){if(p.areDatesInvalid=!C(p.userStartDate,p.userEndDate),!p.areDatesInvalid){var e=Object.assign({},p.requestModel);e.StartDate=p.userStartDate,e.EndDate=p.userEndDate,e.Page=1,l.setQueryParams([{key:"startDate",val:p.userStartDate},{key:"endDate",val:p.userEndDate}])}},p.clearFilters=function(){w(),P(),l.clearQueryParams(),p.filterEvents(p.requestModel)},p.loadNextPage=function(){var e=Object.assign({},p.requestModel);e.Page+=1,p.requestModel=e,u.get(e).then(M).then(function(){n(function(){$(".event-date-bar").sticky(g)})})};var S=function(e,t){Object.prototype.hasOwnProperty.call(p.data,e)||(p.data[e]=t)};p.filterByTerms=function(e,t,a,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=Object.assign({},p.requestModel);switch(t.toLowerCase()){case"locations":E(s.Locations,e,a,t,n,r);break;case"agegroups":E(s.AgeGroups,e,a,t,n,r);break;case"eventtypes":E(s.EventsTypes,e,a,t,n,r)}p.filterEvents(s)};var D=function(){p.isLoading=!1,p.requestErrorMessage="There was a problem retrieving events. Please try again later."},E=function(e,t,a,n,r,s){if(a)e.push(t);else{var o=e.indexOf(t);-1!==o&&e.splice(o,1)}s&&l.updateQueryParams([{key:n,val:r}])},w=function(){p.requestModel=new d},P=function(){p.keywords="",p.userStartDate="",p.userEndDate=""},b=function(e){p.isLastPage=T(e.totalResults),p.eventGroups=e.eventGroups,p.isLoading=!1,p.hasResults=e.eventGroups.length,p.requestErrorMessage="",n(function(){$(".event-date-bar").sticky(g)})},M=function(e){p.isLastPage=T(e.totalResults),p.eventGroups=k(p.eventGroups,e.eventGroups)},T=function(e){return p.requestModel.Page*p.chunkSize>=e},C=function(e,t){return!(!e||!t)&&o.moment(e).isSameOrBefore(t)},O=function(e,t){return!(!e||!t)&&o.moment(e).isSame(t,"day")},k=function(e,t){var a=e,n=a[a.length-1];return angular.forEach(t,function(e){O(n.date,e.date)?n.events=n.events.concat(e.events):a.push(e)}),a},R=function(e){angular.element(e.currentTarget).closest(".expando-wrapper").find("i").toggleClass("fa-plus-square").toggleClass("fa-minus-square")},q=function(){return s.search().term&&s.search().term.length?s.search().term:""};angular.element(document).on("hide.bs.collapse",".expando-wrapper .collapse",R),angular.element(document).on("show.bs.collapse",".expando-wrapper .collapse",R);var L=function(e,t){if(!t)return-1;if(Object.prototype.hasOwnProperty.call(p.data,e)){var a=p.data[e].filter(function(e){return Object.prototype.hasOwnProperty.call(e,"Name")&&e.Name.toLowerCase().trim()===t.toLowerCase().trim()});return"locations"===e?a.length?a[0].LocationId:null:a.length?a[0].Id:null}return-1},j=function(e){return 0===Object.keys(e).length&&e.constructor===Object},A=function(e){return e&&e.toLowerCase().indexOf("date")>-1},U=function(e){return e.replace(/^\w/,function(e){return e.toUpperCase()})},N=function(){var e=Object.assign({},p.requestModel),t=l.getQueryParams();if(j(t))return P(),p.requestModel;var a=q();e.Keyword=a,p.keywords=a;var n=F(t);return n&&(e.StartDate=n.startDate,e.EndDate=n.endDate),Object.keys(t).forEach(function(a){if(!A(a)){var n=t[a];l.getFiltersFromString(n).forEach(function(t){var n=L(a,t);if(n&&n>-1){var r=U(a);r.indexOf("EventTypes")>-1&&(r="EventsTypes"),e[r]=I(e[r],n)}})}}),e},I=function(e,t){var a=e?e.slice():[];return e&&e.length&&e.includes(t)?a=e.filter(function(e){return e!==t}):a.push(t),a},G=function(e,t,a){S(t,e),a&&"function"==typeof a&&a()},Y=function(e,t){t&&"function"==typeof t&&t(e)},x=function(e,t){var a=void 0,n=0;v.forEach(function(r){i.remoteServiceUrls[r]?a=i.remoteServiceUrls[r]:i.serviceUrls[r]&&(a=""+i.baseUrl+i.serviceUrls[r]),c.request(a).then(function(t){return G(t,r,function(){(n+=1)===v.length&&e()})},function(e){return Y(e,t)})})},F=function(e){var t=l.getQueryParamValuesByKey(e,"startDate",!0),a=l.getQueryParamValuesByKey(e,"endDate",!0);return t||a?(p.userStartDate=t,p.userEndDate=a,{startDate:t||f(),endDate:a||m()}):null},B=function(e){var t=N();p.filterEvents(t,e)},_=function(){return u.get(p.requestModel).then(b).catch(D)};a.$on("$locationChangeSuccess",function(){w(),B()}),function(){x(function(){B(!0)},_)}()};a.$inject=["$document","$scope","$timeout","$animate","$location","$window","events.CONSTANTS","dataServices.eventsService","sharedFilters.filterHelperService","metaService","RequestModel"],e.controller("EventsPageCtrl",a)}(angular.module("eventsPageApp"),bcpl.boostrapCollapseHelper),namespacer("bcpl"),bcpl.boostrapCollapseHelper=function(e){return{toggleCollapseByIds:function(t){var a=t.activePanels,n=t.inActivePanels;a.forEach(function(t){e("#"+t).collapse("show")}),n.forEach(function(t){e("#"+t).collapse("hide")})}}}(jQuery),function(){angular.module("eventsPageApp",["dataServices","events","sharedFilters","ngAria","ngRoute","ngSanitize"])}(),function(){var e=angular.module("events",[]),t={baseUrl:"https://testservices.bcpl.info",serviceUrls:{events:"/api/evanced/signup/events",eventRegistration:"/api/evanced/signup/registration",eventTypes:"/api/evanced/signup/eventtypes"},remoteServiceUrls:{ageGroups:"https://bcpl.evanced.info/api/signup/agegroups",locations:"https://bcpl.evanced.info/api/signup/locations"},templateUrls:{datePickersTemplate:"/_js/apps/events-page/templates/datePickers.html",eventsListTemplate:"/_js/apps/events-page/templates/eventsList.html",filtersTemplate:"/_js/apps/events-page/templates/filters.html",filtersExpandosTemplate:"/_js/apps/events-page/templates/filters-expandos.html",loadMoreTemplate:"/_js/apps/events-page/templates/loadMore.html",featuredEventsTemplate:"/_js/apps/events-page/templates/featuredEvents.html"},partialUrls:{eventListPartial:"/_js/apps/events-page/partials/eventList.html",eventDetailsPartial:"/_js/apps/events-page/partials/eventDetails.html",eventRegistrationPartial:"/_js/apps/events-page/partials/eventRegistration.html"},requestChunkSize:10};e.constant("events.CONSTANTS",t)}(),function(e){var t=function(e,t){e.when("/",{templateUrl:t.partialUrls.eventListPartial,controller:"EventsPageCtrl",controllerAs:"eventsPage",reloadOnSearch:!1}).when("/:id",{templateUrl:t.partialUrls.eventDetailsPartial,controller:"EventDetailsCtrl",controllerAs:"eventDetailsPage"}).when("/register/:id",{templateUrl:t.partialUrls.eventRegistrationPartial,controller:"EventRegistrationCtrl",controllerAs:"eventRegistrationPage"})};t.$inject=["$routeProvider","events.CONSTANTS"],e.config(t)}(angular.module("eventsPageApp")),function(e){var t=angular.module("dataServices",[]),a=function(t,a,n){var r=function(e,t){return new Date(e.EventStart).toLocaleDateString()===t},s=function(e){var t=[],a=void 0;return angular.forEach(e,function(n){var s=new Date(n.EventStart).toLocaleDateString();a!==s&&(t.push({date:new Date(n.EventStart),events:e.filter(function(e){return r(e,s)})}),a=s)}),t},o=function(e){return n(function(n,r){a.post(t.baseUrl+t.serviceUrls.events,e).then(function(e){e.data?n({eventGroups:s(e.data.Events),totalResults:e.data.TotalResults}):r(e)},r)})},i=function(r){return n(function(n,s){a.get(t.baseUrl+t.serviceUrls.events+"/"+r).then(function(t){if(t.data){t.data.Description&&(t.data.Description=t.data.Description.replace(/<[\w\/]+>/g,""));t.data.registrationStarts=e(t.data.EventStart).subtract(7,"days"),t.data.registrationEnds=e(t.data.EventStart).subtract(30,"minutes"),t.data.registrationStartsDisplay=u(t.data.registrationStarts.format("M/D/YYYY @ h:mm a")),t.data.registrationEndsDisplay=u(t.data.registrationEnds.format("M/D/YYYY @ h:mm a")),t.data.isStarted=e(t.data.EventStart).isBefore(),t.data.isRegistrationClosed=t.data.registrationEnds.isBefore(),t.data.isRegistrationWindow=e().isBetween(t.data.registrationStarts,t.data.registrationEnds),t.data.isFull=1===t.data.RegistrationTypeCodeEnum&&0===t.data.MainSpotsAvailable,t.data.isWaiting=t.data.WaitSpotsAvailable>0,t.data.requiresRegistration=0!==t.data.RegistrationTypeCodeEnum,t.data.shouldDisplayRegistrationButton=c(t.data),n(t.data)}else s(t)},s)})},u=function(e){return e.replace(":00","").replace(/\w\w$/,function(e){return e.split("").join(".")+"."})},l=function(t){var a=t,n=e(t.EventStart);return a.eventMonth=n.format("MMM"),a.eventDate=n.format("D"),a.eventTime=u(n.format("h:mm a")),a.requiresRegistration=0!==a.RegistrationTypeCodeEnum,a},c=function(e){return!e.isStarted&&e.isRegistrationWindow&&e.requiresRegistration&&(!e.isFull||e.isFull&&e.isWaiting)},d=function(e){var t=[];return e.forEach(function(e){var a=l(e);t.push(a)}),t};return{get:o,getById:i,getFeaturedEvents:function(e){return n(function(n,r){a.post(t.baseUrl+t.serviceUrls.events,e).then(function(e){e.data?n(d(e.data.Events)):r(e)},r)})}}};a.$inject=["events.CONSTANTS","$http","$q"],t.factory("dataServices.eventsService",a)}(window.moment),function(e){var t=function(e,t){return{request:function(a){return t(function(t,n){e.get(a).then(function(e){t(e.data)},function(e){n(e)})})}}};t.$inject=["$http","$q"],e.factory("metaService",t)}(angular.module("eventsPageApp")),function(e){var t=function(e,t,a){return{register:function(n){return a(function(a,r){t.post(e.baseUrl+e.serviceUrls.eventRegistration,n).then(function(e){e.data?a({data:e.data}):r(e)},r)})}}};t.$inject=["events.CONSTANTS","$http","$q"],e.factory("registrationService",t)}(angular.module("eventsPageApp"));var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t=function(){var e=function(e,t){var a="string"==typeof e?new Date(e):e;return"object"!==(void 0===a?"undefined":_typeof(a))||"Invalid Date"===a?a:(a.setDate(a.getDate()+t),a)},t=function(e,t,r){if(r)return"All Day";if(!e||isNaN(Date.parse(e)))return"Bad start date format";if("number"!=typeof t||t<=0)return"Bad event length format";var s=moment(e),o=moment(e).add(t,"m"),i=a(s),u=s.minute(),l=n(s),c=a(o),d=o.minute(),p=n(o);return i+(0===u?"":":"+u)+" "+(l===p?"":l)+" to "+c+(0===d?"":":"+d)+" "+p},a=function(e){var t=e.hour();return 0===t?12:t<=12?t:t-12},n=function(e){return e.hour()<12?"a.m.":"p.m."};return{addDays:e,formatSchedule:t}};e.factory("dateUtilityService",t)}(angular.module("eventsPageApp")),function(e){var t=function(){return{build:function(e){if(!e)return"";var t=Object.entries(e),a="";return t.length&&angular.forEach(t,function(e){a+=e[0]+"="+e[1]+"&"}),a}}};e.factory("querystringService",t)}(angular.module("eventsPageApp")),function(e){var t=function(e,t){return function(a){var n=a||{},r=e.moment().format(),s=e.moment().add(30,"d").format();return{StartDate:n.StartDate||r,EndDate:n.EndDate||s,Page:n.Page||1,IsOngoingVisible:n.IsOngoingVisible||!0,IsSpacesReservationVisible:n.IsSpacesReservationVisible||!1,Limit:n.limit||t.requestChunkSize,EventsTypes:n.eventTypes||[],AgeGroups:n.AgeGroups||[],Locations:n.locations||[],Keyword:n.Keyword||""}}};t.$inject=["$window","events.CONSTANTS"],e.factory("RequestModel",t)}(angular.module("eventsPageApp")),function(e){var t=function(e,t,a,n,r,s){var o=this,i=a.id;o.data={},o.data.EventStartDate="",o.data.EventStartTime="",o.data.EventEndTime="",o.isLoading=!0,o.isError=!1,o.requestErrorMessage="Unfortunately, there was a problem loading this event's details. Please try again in a few minutes.";var u=function(e){o.data=e,o.data.EventStartDate=moment(o.data.EventStart).format("MMMM D, YYYY"),o.data.EventSchedule=s.formatSchedule(o.data.EventStart,o.data.EventLength,o.data.AllDay),o.isRegistrationRequired=0!==o.data.RegistrationTypeCodeEnum,o.isOver=moment().isAfter(moment(o.data.EventStart).add(o.data.EventLength,"m")),o.isLoading=!1},l=function(e){o.isLoading=!1,o.isError=!0};r.getById(i).then(u).catch(l)};t.$inject=["$scope","$timeout","$routeParams","events.CONSTANTS","dataServices.eventsService","dateUtilityService"],e.controller("EventDetailsCtrl",t)}(angular.module("eventsPageApp")),function(e,t){var a=function(e,a,n,r,s,o){var i=n.id,u=this;u.isGroup="false",u.isSubmitted=!1,u.isLoadingResults=!1,u.formConfirmationMessage=null,u.submitHandler=function(){u.isLoadingResults=!0;var e={EventId:parseInt(i,10),FirstName:u.firstName,LastName:u.lastName,Email:u.email,Phone:t("phoneNumber",u.phone,"xxx-xxx-xxxx"),IsGroup:"true"===u.isGroup,GroupCount:u.groupCount};s.register(e).then(function(e){var t=angular.element(".main-content").first().offset().top;u.postResult=e.data;var a=u.postResult.Data;if(a&&Object.prototype.hasOwnProperty.call(u.postResult.Data,"ConfirmationMessage")&&a.ConfirmationMessage.length)u.formConfirmationMessage=a.ConfirmationMessage;else{var n=u.postResult&&Object.prototype.hasOwnProperty.call(u.postResult,"Errors")&&u.postResult.Errors.length;u.formConfirmationMessage=n?u.postResult.Errors[0].Error:"Something went wrong, please try again later"}u.isSubmitted=!0,u.isLoadingResults=!1,angular.element("html, body").animate({scrollTop:t},250)})};var l=function(e){u.data=e,u.data.EventStartDate=moment(u.data.EventStart).format("MMMM D, YYYY"),u.data.EventSchedule=o.formatSchedule(u.data.EventStart,u.data.EventLength,u.data.AllDay)};r.getById(i).then(l)};a.$inject=["$window","$scope","$routeParams","dataServices.eventsService","registrationService","dateUtilityService"],e.controller("EventRegistrationCtrl",a)}(angular.module("eventsPageApp"),bcpl.utility.format),function(e,t){var a=function(e,a,n,r,s,o,i,u,l,c,d){var p=this,v=["locations","eventTypes","ageGroups"],f=function(){return o.moment().format()},m=function(){return o.moment().add(30,"d").format()};p.requestModel=new d;var g={zIndex:100,responsiveWidth:!0};p.eventGroups=[],p.keywords="",p.chunkSize=i.requestChunkSize,p.totalResults=0,p.isLastPage=!1,p.areDatesInvalid=!1,p.isLoading=!0,p.hasResults=!0,p.data={},p.locations=[],p.eventsTypes=[],p.ageGroups=[];var h=function(e){var t=[],a=[];return e.Locations.length?t.push("locations"):a.push("locations"),e.EventsTypes.length?t.push("eventTypes"):a.push("eventTypes"),e.AgeGroups.length?t.push("ageGroups"):a.push("ageGroups"),{activePanels:t,inActivePanels:a}};p.filterEvents=function(a,n,r){p.eventGroups=[],p.isLoading=!0,p.hasResults=!0,p.requestErrorMessage="",p.requestModel=a;var s=angular.element("#start-date")[0]._flatpickr,i=angular.element("#end-date")[0]._flatpickr;e.ready(function(){s.setDate(o.moment(a.StartDate).toDate()),i.setDate(o.moment(a.EndDate).toDate()),p.userStartDate=o.moment(a.StartDate).format("MMMM DD, YYYY"),p.userEndDate=o.moment(a.EndDate).format("MMMM DD, YYYY")}),u.get(a).then(function(e){b(e),p.hasResults=!!y(e);var s=h(a);n&&t.toggleCollapseByIds(s),r&&"function"==typeof r&&r(e)}).catch(D)};var y=function(e){return e&&Object.prototype.hasOwnProperty.call(e,"totalResults")?e.totalResults:0};p.keywordSearch=function(){var e=Object.assign({},p.requestModel);e.Keyword=p.keywords,e.Page=1,l.setQueryParams([{key:"term",val:p.keywords}])},p.filterByDate=function(){if(p.areDatesInvalid=!C(p.userStartDate,p.userEndDate),!p.areDatesInvalid){var e=Object.assign({},p.requestModel);e.StartDate=p.userStartDate,e.EndDate=p.userEndDate,e.Page=1,l.setQueryParams([{key:"startDate",val:p.userStartDate},{key:"endDate",val:p.userEndDate}])}},p.clearFilters=function(){w(),P(),l.clearQueryParams(),p.filterEvents(p.requestModel)},p.loadNextPage=function(){var e=Object.assign({},p.requestModel);e.Page+=1,p.requestModel=e,u.get(e).then(M).then(function(){n(function(){$(".event-date-bar").sticky(g)})})};var S=function(e,t){Object.prototype.hasOwnProperty.call(p.data,e)||(p.data[e]=t)};p.filterByTerms=function(e,t,a,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=Object.assign({},p.requestModel);switch(t.toLowerCase()){case"locations":E(s.Locations,e,a,t,n,r);break;case"agegroups":E(s.AgeGroups,e,a,t,n,r);break;case"eventtypes":E(s.EventsTypes,e,a,t,n,r)}p.filterEvents(s)};var D=function(){p.isLoading=!1,p.requestErrorMessage="There was a problem retrieving events. Please try again later."},E=function(e,t,a,n,r,s){if(a)e.push(t);else{var o=e.indexOf(t);-1!==o&&e.splice(o,1)}s&&l.updateQueryParams([{key:n,val:r}])},w=function(){p.requestModel=new d},P=function(){p.keywords="",p.userStartDate="",p.userEndDate=""},b=function(e){p.isLastPage=T(e.totalResults),p.eventGroups=e.eventGroups,p.isLoading=!1,p.hasResults=e.eventGroups.length,p.requestErrorMessage="",n(function(){$(".event-date-bar").sticky(g)})},M=function(e){p.isLastPage=T(e.totalResults),p.eventGroups=k(p.eventGroups,e.eventGroups)},T=function(e){return p.requestModel.Page*p.chunkSize>=e},C=function(e,t){return!(!e||!t)&&o.moment(e).isSameOrBefore(t)},O=function(e,t){return!(!e||!t)&&o.moment(e).isSame(t,"day")},k=function(e,t){var a=e,n=a[a.length-1];return angular.forEach(t,function(e){O(n.date,e.date)?n.events=n.events.concat(e.events):a.push(e)}),a},R=function(e){angular.element(e.currentTarget).closest(".expando-wrapper").find("i").toggleClass("fa-plus-square").toggleClass("fa-minus-square")},q=function(){return s.search().term&&s.search().term.length?s.search().term:""};angular.element(document).on("hide.bs.collapse",".expando-wrapper .collapse",R),angular.element(document).on("show.bs.collapse",".expando-wrapper .collapse",R);var L=function(e,t){if(!t)return-1;if(Object.prototype.hasOwnProperty.call(p.data,e)){var a=p.data[e].filter(function(e){return Object.prototype.hasOwnProperty.call(e,"Name")&&e.Name.toLowerCase().trim()===t.toLowerCase().trim()});return"locations"===e?a.length?a[0].LocationId:null:a.length?a[0].Id:null}return-1},j=function(e){return 0===Object.keys(e).length&&e.constructor===Object},A=function(e){return e&&e.toLowerCase().indexOf("date")>-1},U=function(e){return e.replace(/^\w/,function(e){return e.toUpperCase()})},N=function(){var e=Object.assign({},p.requestModel),t=l.getQueryParams();if(j(t))return P(),p.requestModel;var a=q();e.Keyword=a,p.keywords=a;var n=F(t);return n&&(e.StartDate=n.startDate,e.EndDate=n.endDate),Object.keys(t).forEach(function(a){if(!A(a)){var n=t[a];l.getFiltersFromString(n).forEach(function(t){var n=L(a,t);if(n&&n>-1){var r=U(a);r.indexOf("EventTypes")>-1&&(r="EventsTypes"),e[r]=I(e[r],n)}})}}),e},I=function(e,t){var a=e?e.slice():[];return e&&e.length&&e.includes(t)?a=e.filter(function(e){return e!==t}):a.push(t),a},G=function(e,t,a){S(t,e),a&&"function"==typeof a&&a()},Y=function(e,t){t&&"function"==typeof t&&t(e)},x=function(e,t){var a=void 0,n=0;v.forEach(function(r){i.remoteServiceUrls[r]?a=i.remoteServiceUrls[r]:i.serviceUrls[r]&&(a=""+i.baseUrl+i.serviceUrls[r]),c.request(a).then(function(t){return G(t,r,function(){(n+=1)===v.length&&e()})},function(e){return Y(e,t)})})},F=function(e){var t=l.getQueryParamValuesByKey(e,"startDate",!0),a=l.getQueryParamValuesByKey(e,"endDate",!0);return t||a?(p.userStartDate=t,p.userEndDate=a,{startDate:t||f(),endDate:a||m()}):null},B=function(e){var t=N();p.filterEvents(t,e)},_=function(){return u.get(p.requestModel).then(b).catch(D)};a.$on("$locationChangeSuccess",function(){w(),B()}),function(){x(function(){B(!0)},_)}()};a.$inject=["$document","$scope","$timeout","$animate","$location","$window","events.CONSTANTS","dataServices.eventsService","sharedFilters.filterHelperService","metaService","RequestModel"],e.controller("EventsPageCtrl",a)}(angular.module("eventsPageApp"),bcpl.boostrapCollapseHelper),function(e){var t=function(e,t,a){return{link:function(a,n,r){var s=a,o=function(){return t.moment().format()},i=function(){return t.moment().add(30,"d").format()};s.areDatesInvalid=!1;var u={dateFormat:"F d, Y",disable:[function(e){return t.moment(e).isBefore(new Date,"day")}],onChange:function(){e(function(){s.userStartDate=s.userStartDate||o(),s.userEndDate=s.userEndDate||i(),e(function(){t.moment(s.userStartDate).isSameOrBefore(s.userEndDate)?(s.areDatesInvalid=!1,s.filterByDate()):s.areDatesInvalid=!0})})}};s.openFlatpickr=function(e){document.querySelector("#"+e)._flatpickr.open()},t.flatpickr("#start-date, #end-date",u)},restrict:"E",templateUrl:a.templateUrls.datePickersTemplate,scope:{userStartDate:"=startDateModel",userEndDate:"=endDateModel",filterByDate:"=filterByDate"}}};t.$inject=["$timeout","$window","events.CONSTANTS"],e.directive("datePickers",t)}(angular.module("eventsPageApp")),function(e){var t=function(e,t,a){var n=function(e){var t=e,n={weekday:"long",year:"numeric",month:"long",day:"numeric"};t.eventScheduleString=function(e){return a.formatSchedule(e.EventStart,e.EventLength,e.AllDay)},t.getDisplayDate=function(e){return e.date.toLocaleDateString("en-US",n)}};return{restrict:"E",templateUrl:t.templateUrls.eventsListTemplate,link:n,scope:{eventGroups:"="}}};t.$inject=["$timeout","events.CONSTANTS","dateUtilityService"],e.directive("eventsList",t)}(angular.module("eventsPageApp")),function(e){var t=function(e,t){return{link:function(e){var t=e;t.search=function(e,a,n){var r=e.item.Id||e.item.LocationId,s=e.item.Name||e.item.Id;t.searchFunction(r,a,n,s,t.items)},t.removeDisallowedCharacters=function(e){var t=/[^A-Za-z0-9-_.]/g;return e.trim().replace(t,"-")},t.isFilterChecked=function(e,a){var n=e&&"locations"===e?a.LocationId:a.Id;return!!t.activeFilters&&t.activeFilters.includes(n)}},restrict:"E",scope:{filterType:"@",choiceType:"@",searchFunction:"=",items:"=",activeFilters:"="},templateUrl:t.templateUrls.filtersExpandosTemplate}};t.$inject=["metaService","events.CONSTANTS"],e.directive("filtersExpandos",t)}(angular.module("eventsPageApp")),function(e){var t=function(e,t){return{link:function(e){var t=e;t.search=function(e,a,n){var r=e.item.Id||e.item.LocationId;t.searchFunction(r,a,n)},t.removeDisallowedCharacters=function(e){var t=/[^A-Za-z0-9-_.]/g;return e.trim().replace(t,"-")},t.isFilterChecked=function(e,a){var n=e&&"locations"===e?a.LocationId:a.Id;return t.activeFilters.includes(n)}},restrict:"E",scope:{filterType:"@",choiceType:"@",searchFunction:"=",activeFilters:"="},templateUrl:t.templateUrls.filtersTemplate}};t.$inject=["metaService","events.CONSTANTS"],e.directive("filters",t)}(angular.module("eventsPageApp")),function(e){var t=function(e){return{restrict:"E",templateUrl:e.templateUrls.loadMoreTemplate,scope:{loadNextPage:"=",chunkSize:"="}}};t.$inject=["events.CONSTANTS"],e.directive("loadMore",t)}(angular.module("eventsPageApp"));