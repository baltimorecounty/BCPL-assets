"use strict";!function(){angular.module("eventsPageApp",["ngAnimate"])}(),function(e){var t={baseUrl:"http://ba224964:3100",serviceUrls:{events:"/api/evanced/signup/events"},templateUrls:{datePickersTemplate:"/dist/js/apps/events-page/templates/datePickers.html",eventsListTemplate:"/dist/js/apps/events-page/templates/eventsList.html",loadMoreTemplate:"/dist/js/apps/events-page/templates/loadMore.html"},requestChunkSize:10};e.constant("CONSTANTS",t)}(angular.module("eventsPageApp")),function(e){var t=function(e,t,n){var a=function(e,t){return new Date(e.EventStart).toLocaleDateString()===t},r=function(e){var t=[],n=void 0;return angular.forEach(e,function(r){var o=new Date(r.EventStart).toLocaleDateString();n!==o&&(t.push({date:new Date(r.EventStart),events:e.filter(function(e){return a(e,o)})}),n=o)}),t};return{get:function(a){var o=a;return n(function(n,a){t.post(e.baseUrl+e.serviceUrls.events,o).then(function(e){e.data?n({eventGroups:r(e.data.Events),totalResults:e.data.TotalResults}):a(e)},a)})}}};t.$inject=["CONSTANTS","$http","$q"],e.factory("eventsService",t)}(angular.module("eventsPageApp"));var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t=function(){var e=function(e,t){var n="string"==typeof e?new Date(e):e;return"object"!==(void 0===n?"undefined":_typeof(n))||"Invalid Date"===n?n:(n.setDate(n.getDate()+t),n)},t=function(e,t){if(!e||isNaN(Date.parse(e)))return"Bad start date format";if("number"!=typeof t||t<=0)return"Bad event length format";var o=new Date(e),u=new Date(e),i=o.getMinutes()+t;return u.setMinutes(i),n(o)+":"+r(o.getMinutes())+" "+a(o)+" to "+n(u)+":"+r(u.getMinutes())+" "+a(u)},n=function(e){var t=e.getHours();return 0===t?12:t<=12?t:t-12},a=function(e){return e.getHours()<12?"a.m.":"p.m."},r=function(e){return e<10?"0"+e:""+e};return{addDays:e,formatSchedule:t}};e.factory("dateUtilityService",t)}(angular.module("eventsPageApp")),function(e){var t=function(){return{build:function(e){if(!e)return"";var t=Object.entries(e),n="";return t.length&&angular.forEach(t,function(e){n+=e[0]+"="+e[1]+"&"}),n}}};e.factory("querystringService",t)}(angular.module("eventsPageApp")),function(e){var t=function(e,t,n,a,r){var o=this,u=(new Date).toLocaleString(),i=new Date;i.setMonth(i.getMonth()+1);var s=i.toLocaleString(),c={StartDate:u,EndDate:s,Page:1,IsOngoingVisible:!0,Limit:a.requestChunkSize},l={zIndex:100,responsiveWidth:!0};o.eventGroups=[],o.keywords="",o.chunkSize=a.requestChunkSize,o.totalResults=0,o.isLastPage=!1,o.areDatesInvalid=!1,o.keywordSearch=function(){c.Keyword=o.keywords,c.StartDate=u,c.Page=1,o.eventGroups=[],r.get(c).then(v)},o.filterByDate=function(){p(o.userStartDate,o.userEndDate)?(o.areDatesInvalid=!1,c.StartDate=o.userStartDate,c.EndDate=o.userEndDate,c.Page=1,o.eventGroups=[],r.get(c).then(v)):o.areDatesInvalid=!0},o.loadNextPage=function(){c.Page+=1,r.get(c).then(d)},o.clearFilters=function(){c.StartDate=u,c.EndDate=s,c.Page=1,c.Keyword="",o.keywords="",o.userStartDate="",o.userEndDate="",o.eventGroups=[],r.get(c).then(v)};var v=function(e){o.isLastPage=f(e.totalResults),o.eventGroups=e.eventGroups,t(function(){$(".event-date-bar").sticky(l)})},d=function(e){o.isLastPage=f(e.totalResults),o.eventGroups=m(o.eventGroups,e.eventGroups)},f=function(e){return c.Page*o.chunkSize>=e},p=function(e,t){return!(!e||!t)&&moment(e).isSameOrBefore(t)},g=function(e,t){return!(!e||!t)&&moment(e).isSame(t,"day")},m=function(e,t){var n=e,a=n[n.length-1];return angular.forEach(t,function(e){g(a.date,e.date)?a.events=a.events.concat(e.events):n.push(e)}),n};r.get(c).then(v)};t.$inject=["$scope","$timeout","$animate","CONSTANTS","eventsService","dateUtilityService"],e.controller("EventsPageCtrl",t)}(angular.module("eventsPageApp")),function(e){var t=function(e,t){return{link:function(t,n,a){var r=t;r.areDatesInvalid=!1;var o={dateFormat:"F d, Y",disable:[function(e){return moment(e).isBefore(new Date,"day")}],onChange:function(){e(function(){r.userStartDate=r.userStartDate||r.userEndDate,r.userEndDate=r.userEndDate||r.userStartDate,e(function(){moment(r.userStartDate).isSameOrBefore(r.userEndDate)?(r.areDatesInvalid=!1,r.filterByDate()):r.areDatesInvalid=!0})})}};r.openFlatpickr=function(e){document.querySelector("#"+e)._flatpickr.open()},flatpickr("#start-date, #end-date",o)},restrict:"E",templateUrl:t.templateUrls.datePickersTemplate,scope:{userStartDate:"=startDateModel",userEndDate:"=endDateModel",filterByDate:"=filterByDate"}}};t.$inject=["$timeout","CONSTANTS"],e.directive("datePickers",t)}(angular.module("eventsPageApp")),function(e){var t=function(e,t,n){var a=function(e){var t=e,a={weekday:"long",year:"numeric",month:"long",day:"numeric"};t.eventScheduleString=function(e){return n.formatSchedule(e.EventStart,e.EventLength)},t.getDisplayDate=function(e){return e.date.toLocaleDateString("en-US",a)}};return{restrict:"E",templateUrl:t.templateUrls.eventsListTemplate,link:a,scope:{eventGroups:"="}}};t.$inject=["$timeout","CONSTANTS","dateUtilityService"],e.directive("eventsList",t)}(angular.module("eventsPageApp")),function(e){var t=function(e){return{restrict:"E",templateUrl:e.templateUrls.loadMoreTemplate,scope:{loadNextPage:"=",chunkSize:"="}}};t.$inject=["CONSTANTS"],e.directive("loadMore",t)}(angular.module("eventsPageApp"));