"use strict";!function(e){var t=angular.module("dataServices",[]),a=function(t,a,n){var s=function(e,t){return new Date(e.EventStart).toLocaleDateString()===t},r=function(e){var t=[],a=void 0;return angular.forEach(e,function(n){var r=new Date(n.EventStart).toLocaleDateString();a!==r&&(t.push({date:new Date(n.EventStart),events:e.filter(function(e){return s(e,r)})}),a=r)}),t},i=function(e){return e.replace(":00","").replace(/\w\w$/,function(e){return e.split("").join(".")+"."})},l=function(t){var a=t,n=e(t.EventStart);return a.eventMonth=n.format("MMM"),a.eventDate=n.format("D"),a.eventTime=i(n.format("h:mm a")),a.requiresRegistration=0!==a.RegistrationTypeCodeEnum,a},o=function(e){return!e.isStarted&&e.requiresRegistration&&(!e.isFull||e.isFull&&e.isWaiting)},p=function(e){var t=[];return e.forEach(function(e){var a=l(e);t.push(a)}),t};return{get:function(e){return n(function(n,s){a.post(t.baseUrl+t.serviceUrls.events,e).then(function(e){e.data?n({eventGroups:r(e.data.Events),totalResults:e.data.TotalResults}):s(e)},s)})},getById:function(s){return n(function(n,r){a.get(t.baseUrl+t.serviceUrls.events+"/"+s).then(function(t){t.data?(t.data.Description&&(t.data.Description=t.data.Description.replace(/<[\w\/]+>/g,"")),t.data.isStarted=e(t.data.EventStart).isBefore(),t.data.isFull=0===t.data.MainSpotsAvailable,t.data.isWaiting=t.data.WaitSpotsAvailable>0,t.data.requiresRegistration=0!==t.data.RegistrationTypeCodeEnum,t.data.shouldDisplayRegistrationButton=o(t.data),n(t.data)):r(t)},r)})},getFeaturedEvents:function(e){return n(function(n,s){a.post(t.baseUrl+t.serviceUrls.events,e).then(function(e){e.data?n(p(e.data.Events)):s(e)},s)})}}};a.$inject=["events.CONSTANTS","$http","$q"],t.factory("dataServices.eventsService",a)}(window.moment),function(){angular.module("featuredEventsWidgetApp",["dataServices","events","ngAria"])}(),function(){var e=angular.module("events",[]),t={baseUrl:"http://oit226471:1919",serviceUrls:{events:"/api/evanced/signup/events",eventRegistration:"/api/evanced/signup/registration"},remoteServiceUrls:{ageGroups:"https://bcpl.evanced.info/api/signup/agegroups",eventTypes:"https://bcpl.evanced.info/api/signup/eventtypes",locations:"https://bcpl.evanced.info/api/signup/locations"},templateUrls:{datePickersTemplate:"/_js/apps/events-page/templates/datePickers.html",eventsListTemplate:"/_js/apps/events-page/templates/eventsList.html",filtersTemplate:"/_js/apps/events-page/templates/filters.html",filtersExpandosTemplate:"/_js/apps/events-page/templates/filters-expandos.html",loadMoreTemplate:"/_js/apps/events-page/templates/loadMore.html",featuredEventsTemplate:"/_js/apps/events-page/templates/featuredEvents.html"},partialUrls:{eventListPartial:"/_js/apps/events-page/partials/eventList.html",eventDetailsPartial:"/_js/apps/events-page/partials/eventDetails.html",eventRegistrationPartial:"/_js/apps/events-page/partials/eventRegistration.html"},requestChunkSize:10};e.constant("events.CONSTANTS",t)}(),function(e){var t=function(e,t){var a=e.branches&&e.branches.length?e.branches:[],n=e.eventTypes&&e.eventTypes.length?e.eventTypes:[],s=e.resultsToDisplay||3,r=!!e.prioritizeFeatured,i=function(e){return console.error(e)},l=function(e,t,s,r){var i={Limit:e,OnlyFeaturedEvents:r};return a.length&&(i.Locations=t),n.length&&(i.EventsTypes=s),i}(s,a,n,r);t.getFeaturedEvents(l).then(function(t){e.featuredEventList=t,0===t.length&&(e.resultsToDisplay=0)}).catch(i)},a=function(e,a){return{restrict:"E",scope:{branches:"=",resultsToDisplay:"=",eventTypes:"=",prioritizeFeatured:"="},templateUrl:e.templateUrls.featuredEventsTemplate,link:function(e){return t(e,a)}}};a.$inject=["events.CONSTANTS","dataServices.eventsService"],e.directive("featuredEvents",a)}(angular.module("featuredEventsWidgetApp"));