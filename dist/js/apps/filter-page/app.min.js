"use strict";!function(){angular.module("filterPageApp",["ngAnimate"])}(),function(t){var a=function(){var t={name:0,url:1,description:2,inPerson:3,requiresCard:4,attributes:5},a=function(t){var a=[];return t.each(function(t,e){a.push($(e).text())}),a},e=function(e,r){var i=$(e).find("#data-table"),n=i.find("tbody tr"),l=[];n.each(function(e,r){var i=$(r);l.push({name:i.find("td").eq(t.name).text(),url:i.find("td").eq(t.url).text(),description:i.find("td").eq(t.description).text(),inPerson:i.find("td").eq(t.inPerson).text(),requiresCard:i.find("td").eq(t.requiresCard).text(),attributes:a(i.find("td").eq(t.attributes).find(".SETags"))})}),r(l)};return{template:'<div class="card">\t<div class="row">\t\t<div class="col-sm-12 branch-address">\t\t\t<h2>\t\t\t\t<a href="#">{{cardData.name}}</a>\t\t\t</h2>\t\t\t<p>{{cardData.description}}</p>\t\t\t<div class="tags">\t\t\t\t<ul class="tag-list">\t\t\t\t\t<tag tag-data="cardData" active-filters="activeFilters" filter-handler="filterHandler"></tag>\t\t\t\t</ul>\t\t\t</div>\t\t</div>\t</div></div>',get:function(t,a){$.ajax("/mockups/data/bcpl-databases.html").done(function(a){e(a,t)}).fail(a)}}};t.factory("databasesService",a)}(angular.module("filterPageApp")),function(t){var a=function(){return{template:'<div class="card">\t<div class="row">\t\t<div class="col-sm-3 branch-name">\t\t\t<div class="branch-photo" style="background: url(/dist/images/branches/{{cardData.photo}})">\t\t\t\t<a href="#">{{cardData.name}}\t\t\t\t\t<i class="fa fa-caret-right" aria-hidden="true"></i>\t\t\t\t</a>\t\t\t</div>\t\t</div>\t\t<div class="col-sm-4 branch-address">\t\t\t<h2>{{cardData.name}} Branch</h2>\t\t\t<address>\t\t\t\t{{cardData.address}}\t\t\t\t<br/> {{cardData.city}}, MD {{cardData.zip}}\t\t\t</address>\t\t</div>\t\t<div class="col-sm-5 branch-email-phone">\t\t\t<div class="branch-email-phone-wrapper">\t\t\t\t<a href="mailto:{{cardData.email}}" class="branch-email">\t\t\t\t\t<i class="fa fa-envelope" aria-hidden="true"></i> Contact {{cardData.name}}\t\t\t\t</a>\t\t\t\t<a href="tel:{{cardData.phone}}" class="branch-phone">\t\t\t\t\t<i class="fa fa-phone" aria-hidden="true"></i> {{cardData.phone}}\t\t\t\t</a>\t\t\t</div>\t\t\t\t</div>\t</div>\t<div class="row">\t\t<div class="col-xs-12">\t\t\t<div class="tags">\t\t\t\t<ul class="tag-list">\t\t\t\t\t<tag tag-data="cardData" active-filters="activeFilters" filter-handler="filterHandler"></tag>\t\t\t\t</ul>\t\t\t</div>\t\t</div>\t</div></div>',get:function(t,a){$.ajax("/mockups/data/branch-amenities.json").done(t).fail(a)}}};t.factory("locationsService",a)}(angular.module("filterPageApp")),function(t){var a=function(t,a,e){var r=function(t){var a=[];angular.forEach(t,function(t){a=a.concat(t.attributes)});var e=_.uniq(a);return _.sortBy(e,function(t){return t})},i=function(t){var a=t.split("/");return a[a.length-1].split(".")[0]};return{get:function(t){var n=i(a.location.pathname);e.get(n+"Service").get(function(a){var e=r(a);t(e,a)})}}};a.$inject=["$location","$window","$injector"],t.factory("cardService",a)}(angular.module("filterPageApp")),function(t){var a=function(){var t={name:0,tag:1,type:2},a=function(t){if("string"==typeof t){var a=t.trim().split("|");return a.length>1?a[1]:a[0]}return""},e=function(t,a){var e=t.filter(function(t){return t.name===a});return 1===e.length?e[0]:void 0},r=function(t,a,e){return{name:t,type:e,tags:[a]}};return{parseTags:function(a){if(!Array.isArray(a))return[];var i=[];return a.forEach(function(a){var n=a.split("|").map(function(t){return t.trim()});1===n.length&&n.unshift("none"),2===n.length&&n.push("many");var l=e(i,n[t.name]);if(l)l.tags.push(n[t.tag]),l.type=n[t.type];else{var c=r(n[t.name],n[t.tag],n[t.type]);i.push(c)}}),i},extractTagName:a}};t.factory("tagParsingService",a)}(angular.module("filterPageApp")),function(t){var a=function(t,a,e,r){var i=this;i.activeFilters=[],i.allCardData={},i.setFilter=function(t,a){var e=angular.element("#results-display");s(t,a),i.items=i.allCardData.filter(c),e.trigger("bcpl.filter.changed",{items:i.items})};var n=function(t,a){i.filters=t,i.allCardData=a,i.items=a,angular.element("#results-display").trigger("bcpl.filter.changed",{items:i.items})},l=function(t){var a=t.attributes,r=[];return a.forEach(function(t){r.push(e.extractTagName(t))}),r},c=function(t){var a=0;if(!t)return!1;var e=l(t);return angular.forEach(i.activeFilters,function(t){-1!==e.indexOf(t)&&(a+=1)}),a===i.activeFilters.length},s=function(t,a){var e=i.activeFilters.indexOf(t),r=-1===e,n="one"===a.type.trim().toLowerCase(),l=[];r&&n&&angular.forEach(a.tags,function(a){a!==t&&l.push(a)}),angular.forEach(l,function(t){i.activeFilters.splice(i.activeFilters.indexOf(t),1)}),r?i.activeFilters.push(t):i.activeFilters.splice(e,1)};a.get(n)};a.$inject=["$scope","cardService","tagParsingService","$animate"],t.controller("FilterPageCtrl",a)}(angular.module("filterPageApp")),function(t){var a=function(t,a){return{restrict:"E",scope:{filterHandler:"=",cardData:"=",activeFilters:"=",template:"="},template:"",link:function(e,r,i){r.append(t(a.get(i.template+"Service").template)(e))}}};a.$inject=["$compile","$injector"],t.directive("card",a)}(angular.module("filterPageApp")),function(t){var a=function(){return{scope:{tag:"=",activeFilters:"=",filterHandler:"=",filterFamily:"="},restrict:"E",templateUrl:"/dist/js/apps/filter-page/templates/filter.html",link:function(t,a){var e=angular.element(a),r=e.find("input"),i="many"===t.filterFamily.type.trim().toLowerCase()?"checkbox":"radio";r.prop("type",i),"radio"===i&&r.prop("name",t.filterFamily.name),t.toggleFilter=function(a){t.isFilterChecked=e.has(":checked").length>0,t.filterHandler(a,t.filterFamily)}}}};a.$inject=[],t.directive("filter",a)}(angular.module("filterPageApp")),function(t){var a=function(t){return{scope:{filterHandler:"=",filterData:"=",activeFilters:"="},restrict:"E",templateUrl:"/dist/js/apps/filter-page/templates/filters.html",link:function(a){a.filterFamilies=t.parseTags(a.filterData)}}};a.$inject=["tagParsingService"],t.directive("filters",a)}(angular.module("filterPageApp")),function(t){var a=function(t){return{scope:{filterHandler:"=",tagData:"=",activeFilters:"="},restrict:"E",template:'<li ng-repeat="tag in tagData.attributes"><button ng-click="toggleFilter(tag, $event)" ng-class="{active: activeFilters.indexOf(extractTagName(tag)) !== -1}">{{extractTagName(tag)}}</button></li>',link:function(a){a.toggleFilter=function(e){var r=t.parseTags(a.tagData.attributes),i=t.extractTagName(e),n=r.filter(function(t){return-1!==t.tags.indexOf(i)})[0];a.filterHandler(i,n)},a.extractTagName=t.extractTagName}}};a.$inject=["tagParsingService"],t.directive("tag",a)}(angular.module("filterPageApp"));