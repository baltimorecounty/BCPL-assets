"use strict";!function(){angular.module("filterPageApp",["ngAnimate"])}(),function(t){var e={templates:{databases:"/dist/js/apps/filter-page/templates/card-databases.html",locations:"/dist/js/apps/filter-page/templates/card-locations.html"},urls:{databases:"http://ba224964:1000/api/bcpl/databases",locations:"/mockups/data/branch-amenities.json"}};t.constant("CONSTANTS",e)}(angular.module("filterPageApp")),function(t){var e=function(){return function(t,e){var a=[];return angular.forEach(t,function(t){var n=0;angular.forEach(t.Tags,function(t){-1!==e.indexOf(t.Tag)&&(n+=1)}),n===e.length&&a.push(t)}),a}};e.$inject=[],t.filter("cardVisibilityFilter",e)}(angular.module("filterPageApp")),function(t){var e=function(t){return{get:function(e,a){$.ajax(t.urls.databases).done(e).fail(a)}}};e.$inject=["CONSTANTS"],t.factory("databasesService",e)}(angular.module("filterPageApp")),function(t){var e=function(t){var e=function(t,e){e("string"==typeof t?JSON.parse(t):t)};return{get:function(a,n){$.ajax(t.urls.locations).done(function(t){e(t,a)}).fail(n)}}};e.$inject=["CONSTANTS"],t.factory("locationsService",e)}(angular.module("filterPageApp")),function(t){var e=function(t,e,a){var n=function(t){var e=t.split("/");return e[e.length-1].split(".")[0]};return{get:function(t){var r=n(e.location.pathname);a.get(r+"Service").get(function(e){var a=_.sortBy(e,function(t){return t.Title});t(a)})}}};e.$inject=["$location","$window","$injector"],t.factory("cardService",e)}(angular.module("filterPageApp")),function(t){var e=function(){var t=function(t){var e=[];return angular.forEach(t,function(t){e=e.concat(t.Tags)}),e},e=function(t){return _.uniq(_.pluck(t,"Name"),function(t){return t})},a=function(t,e){var a=_.where(e,{Name:t});return _.uniq(_.sortBy(_.pluck(a,"Tag"),function(t){return t}),function(t){return t})},n=function(t,e){return _.findWhere(e,{Name:t}).Type};return{build:function(r){var i=[],l=t(r),c=e(l);return angular.forEach(c,function(t){i.push({name:t,tags:a(t,l),type:n(t,l)})}),i}}};t.factory("filterService",e)}(angular.module("filterPageApp")),function(t){var e=function(t,e,a,n,r){var i=this;i.activeFilters=[],i.allCardData={},i.isEverythingFilteredOut=!1,i.setFilter=function(t,e){var a=angular.element("#results-display");o(t,e),n.addClass(a,"fade-out"),i.items=i.allCardData.filter(u),a.trigger("bcpl.filter.changed",{items:i.items}),bcpl.utility.windowShade.cycle(250,2e3),r(function(){n.removeClass(a,"fade-out")},250)};var l=function(e){if(e.length){var n=Object.prototype.hasOwnProperty.call(e[0],"Tags")?e:c(e);i.filters=a.build(n),i.allCardData=n,i.items=n,angular.element("#results-display").trigger("bcpl.filter.changed",{items:i.items}),t.$apply()}},c=function(t){var e=[];return angular.forEach(t,function(t){var a=angular.extend(t,{Tags:[]});angular.forEach(t.attributes,function(t){var e={Name:"none",Tag:t,Type:"Many"};a.Tags.push(e)}),e.push(a)}),e},u=function(t){var e=0;if(!t)return!1;var a=_.pluck(t.Tags,"Tag");return angular.forEach(i.activeFilters,function(t){-1!==a.indexOf(t)&&(e+=1)}),e===i.activeFilters.length},o=function(t,e){var a=e,n=Object.prototype.hasOwnProperty.call(t,"Tag"),r=n?t.Tag:t,l=i.activeFilters.indexOf(r),c=-1===l;n&&(a=_.where(i.filters,{name:t.Name}),1===a.length&&(a=a[0]));var u="one"===a.type.toLowerCase(),o=[];c&&u&&angular.forEach(a.tags,function(t){t!==r&&o.push(t)}),angular.forEach(o,function(t){-1!==i.activeFilters.indexOf(t)&&i.activeFilters.splice(i.activeFilters.indexOf(t),1)}),c?i.activeFilters.push(r):i.activeFilters.splice(l,1)},s=function(t){angular.element(t.currentTarget).siblings(".collapse-control").html('<i class="fa fa-minus"></i> Hide Filters')},f=function(t){angular.element(t.currentTarget).siblings(".collapse-control").html('<i class="fa fa-plus"></i> Show Filters')};e.get(l),angular.element(document).on("show.bs.collapse","#filters",s),angular.element(document).on("hide.bs.collapse","#filters",f)};e.$inject=["$scope","cardService","filterService","$animate","$timeout"],t.controller("FilterPageCtrl",e)}(angular.module("filterPageApp")),function(t){var e=function(t,e,a,n){return{restrict:"E",scope:{filterHandler:"=",cardData:"=",activeFilters:"=",template:"="},template:"",link:function(e,r,i){a(n.templates[i.template]).then(function(a){r.append(t(a)(e))})}}};e.$inject=["$compile","$injector","$templateRequest","CONSTANTS"],t.directive("card",e)}(angular.module("filterPageApp")),function(t){var e=function(){return{scope:{tag:"=",activeFilters:"=",filterHandler:"=",filterFamily:"="},restrict:"E",templateUrl:"/dist/js/apps/filter-page/templates/filter.html",link:function(t,e){var a=angular.element(e),n=a.find("input"),r="many"===t.filterFamily.type.trim().toLowerCase()?"checkbox":"radio";n.prop("type",r),"radio"===r&&n.prop("name",t.filterFamily.name),t.toggleFilter=function(e){t.isFilterChecked=a.has(":checked").length>0,t.filterHandler(e,t.filterFamily)}}}};e.$inject=[],t.directive("filter",e)}(angular.module("filterPageApp")),function(t){var e=function(){return{scope:{filterHandler:"=",filterData:"=",activeFilters:"="},restrict:"E",templateUrl:"/dist/js/apps/filter-page/templates/filters.html",link:function(t){t.$watch("filterData",function(){t.filterFamilies=t.filterData})}}};e.$inject=[],t.directive("filters",e)}(angular.module("filterPageApp")),function(t){var e=function(){return{scope:{filterHandler:"=",tagData:"=",activeFilters:"="},restrict:"E",templateUrl:"/dist/js/apps/filter-page/templates/tag.html",link:function(t){t.toggleFilter=function(e){var a=t.tagData.Tags.filter(function(t){return t.Tag===e.Tag});a.length&&t.filterHandler(e,a[0])}}}};e.$inject=[],t.directive("tag",e)}(angular.module("filterPageApp"));